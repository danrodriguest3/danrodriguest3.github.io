<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Happy Birthday AR</title>
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
    <meta name="referrer" content="origin-when-cross-origin" />
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }

            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @font-face {
            font-family: 'Helvetica Neue';
            src: url('fonts/helvetica/Helvetica\ Neue\ Medium\ Extended.otf');
        }

        @font-face {
            font-family: 'Helvetica Neue Light';
            src: url('fonts/helvetica/Helvetica\ Neue\ UltraLight.otf');
        }

        .inputLabel {
            color: white;
            font-family: 'Helvetica Neue';
            font-weight: medium;
            font-size: 4vw;
        }

        .mainInput {
            border: none;
            width: 100%;
        }

        .inputInstruction {
            color: white;
            font-family: 'Helvetica Neue';
            font-weight: medium;
            font-size: 3vw;
        }

        .btnText {
            margin: auto;
            font-family: 'Helvetica Neue Light';
            font-weight: bold;
            letter-spacing: .25vw;
        }

        .action-bar-container {
            position: fixed;
            padding: 10px;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #000000;
            z-index: 1;
        }

        .detail-line {
            background: #FF086E;
            width: 120px;
            height: 2px;
        }

        .action-bar-buttons {
            margin: auto;
            width: 95%;
            padding-top: 16px;
            padding-bottom: 16px;
            display: flex;
            justify-content: center;
        }

        .action-bar-button {
            display: flex;
            justify-content: center;
            flex-direction: column;
            align-items: center;
            align-content: center;

            background-color: rgba(0, 0, 0, 0.6);
            color: rgb(230, 230, 230);
            padding: 8px 4px;
            text-align: center;
            text-decoration: none;
            margin: auto;
            font-size: 16px;
            width: 110px;
        }

        .action-bar-button svg {
            margin-bottom: 15px;
            height: 32px;
        }

        .review-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgb(255, 255, 255);
            display: none;
            z-index: 3;
        }

        .review-modal-close-btn-container {
            width: 100%;
            padding-top: 16px;
            padding-bottom: 16px;
            padding-left: 8px;
            background-color: rgba(0, 0, 0, 0.6);
            pointer-events: none;
        }

        .review-modal-close-btn {
            background-color: rgba(0, 0, 0, 0.6);
            border: solid;
            border-radius: 12px;
            border-width: 1px;
            color: rgb(230, 230, 230);
            padding: 8px;
            text-align: center;
            text-decoration: none;
            font-size: 12px;
            pointer-events: auto;
        }

        .review-modal-loader {
            position: fixed;
            top: 25%;
            z-index: -1;
            left: 50%;
            margin-left: -40px;
            border: 10px solid #f3f3f3;
            border-radius: 50%;
            border-top: 10px solid #00ff00;
            width: 80px;
            height: 80px;
            -webkit-animation: spin 2s linear infinite;
            /* Safari */
            animation: spin 2s linear infinite;
        }

    </style>
    <script src="js/aframe.min.js"></script>
    <script src="js/aframe-particle-system-component.min.js"></script>
    <script xmlns="http://www.w3.org/1999/xhtml" async=""
        src="https://cdn.rawgit.com/eligrey/FileSaver.js/5ed507ef8aa53d8ecfea96d96bc7214cd2476fd2/FileSaver.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js" crossorigin="anonymous"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155137525-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-155137525-2');
    </script>
    <script>
        AFRAME.registerComponent('autoscale', {
            init: function () {
                this.scale();
            },
            scale: function () {
                const el = this.el;
                const span = this.data;
                const mesh = el.getObject3D('mesh');

                if (!mesh)
                    return;

                // Compute bounds.
                const bbox = new THREE.Box3().setFromObject(mesh);

                // Normalize scale.
                const scale = span / bbox.getSize().length();
                mesh.scale.set(scale, scale, scale);

                // Recenter.
                const offset = bbox.getCenter().multiplyScalar(scale);
                mesh.position.sub(offset);
            }
        });
        var xpType = '', xpTitle = '';
        function takePhoto() {
            document.getElementById('review_modal').style.display = 'block';
            const myImgElem = document.getElementById('review-img');
            myImgElem.src = '';
            myImgElem.style.display = 'none';
            const canvas = document.getElementById('input-video');
            html2canvas(canvas).then(function (canvas) {
                // Getting video and object as canvases
                var canvas_video = canvas.toDataURL();
                var canvas_objects = document.querySelector('[arjs]').components.screenshot.getCanvas('perspective').toDataURL();
                // ===================== Building composite canvas ====================== //
                var _canvas1 = document.getElementById('canvas1');
                if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                    _canvas1.height = canvas.height * 1.1;
                    _canvas1.width = canvas.width * 1.1;
                } else {
                    _canvas1.height = canvas.height;
                    _canvas1.width = canvas.width;
                }
                var _ctx1 = _canvas1.getContext('2d');
                // Draw video background
                var img = new Image;
                img.onload = function () {
                    _ctx1.clearRect(0, 0, _canvas1.width, _canvas1.height);
                    if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                        _ctx1.drawImage(img, 0, 0, _canvas1.width * 1.1, _canvas1.height * 1.1, 0, 0, _canvas1.width * 1.21, _canvas1.height * 1.21);
                    } else {
                        _ctx1.drawImage(img, 0, 0, _canvas1.width, _canvas1.height, 0, 0, _canvas1.width, _canvas1.height);
                    }
                };
                img.src = canvas_video;
                // Draw 3d elements
                var ovr = new Image;
                ovr.onload = function () {
                    if (canvas.width > canvas.height) {
                        _ctx1.drawImage(ovr, 0, 0, ovr.width, ovr.height, 0, 0, img.width, img.height);
                    } else {
                        _ctx1.drawImage(ovr, 2048 - (_canvas1.height / 2), 1024 - (_canvas1.width / 2), _canvas1.height, _canvas1.width, 0, -80, _canvas1.width, _canvas1.height);
                    }
                }
                ovr.src = canvas_objects;
                // Get data from new canvas
                setTimeout(() => {
                    var _image = _canvas1.toDataURL("image/png");
                    myImgElem.src = _image;
                    document.getElementById('review-img').style.display = 'inline';
                }, 250);
            });
        }
        function resetPosition() {
            const _old_camera = document.querySelector('a-camera');
            const _sceneEl = document.querySelector('a-scene');
            const _obj = document.getElementById('3d-object');
            var _camera = document.createElement('a-camera');
            _sceneEl.appendChild(_camera);
            _camera.setAttribute('look-controls', 'enabled: false');
            _camera.setAttribute('camera', 'active', true);
            _sceneEl.removeChild(_old_camera);
            _obj.setAttribute('autoscale', 1);
        }
        const state = {
            running: false,
            handDetected: false,
            xpStarted: false,
            isMobile: false,
        }
        const hands = new Hands({
            locateFile: (file) => {
                return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
            }
        });
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('confettiRL').object3D.visible = false;
            document.getElementById('confettiLR').object3D.visible = false;
            document.getElementById('confettiBL').object3D.visible = false;
            document.getElementById('confettiBR').object3D.visible = false;
            xpType = 'qrevent'; //_data.attributes[1].value;
            xpTitle = 't3cake'; //_data.attributes[2].value;
            document.addEventListener('loaded', [rdnTx()]);
            const videoElement = document.querySelector('#input-video');
            videoElement.pause();
            videoElement.play();
            state.isMobile = AFRAME.utils.device.isMobile();
            hands.setOptions({
                maxNumHands: 1,
                modelComplexity: 1,
                minDetectionConfidence: 0.9,
                minTrackingConfidence: 0.9,
                selfieMode: true
            });

            const camera = new Camera(videoElement, {
                onFrame: async () => {
                    await hands.send({ image: videoElement })
                },
                width: state.isMobile ? innerHeight : innerWidth,
                height: state.isMobile ? innerWidth : innerHeight
            });
            hands.onResults(r => {
                state.handDetected = r.multiHandLandmarks.length > 0;
                updateState(r);
            });
            camera.start();
        });
        function closeReview() {
            document.getElementById('review_modal').style.display = 'none';
        }
        async function rdnTx() {
            if (xpType === 'qrevent') {
                if (xpTitle === 't3cake') {
                    const knownMat = [];
                    const genMat = [];
                    var obj = document.getElementById('3d-object');
                    await obj.addEventListener('model-loaded', async (e) => {
                        var _obj = obj.getObject3D('mesh');
                        let _index = 0;
                        await _obj.traverse(async function (node) {
                            if (node.isMesh)
                                if (!knownMat.includes(node.material.name)) {
                                    knownMat.push(node.material.name);
                                    var tempCanvas = document.createElement('canvas');
                                    var tempCtx = tempCanvas.getContext('2d');
                                    tempCanvas.width = 256;
                                    tempCanvas.height = 256;
                                    var grd = tempCtx.createLinearGradient(0, 0, tempCanvas.width, 0);
                                    const hs = [Math.random() * 360, Math.random() * 360];
                                    const ss = [Math.floor(Math.random() * (70 + 1)), Math.floor(Math.random() * (70 + 1))];
                                    const ls = [Math.floor((1 + Math.random()) * (70 / 2 + 1)), Math.floor((1 + Math.random()) * (70 / 2 + 1))];
                                    grd.addColorStop(0, "hsl(" + hs[0] + ", " + ss[0] + "%, " + ls[0] + "%)");
                                    grd.addColorStop(.5, "hsl(" + hs[1] + ", " + ss[1] + "%, " + ls[1] + "%)");
                                    grd.addColorStop(1, "hsl(" + hs[0] + ", " + ss[0] + "%, " + ls[0] + "%)");
                                    tempCtx.fillStyle = grd;
                                    await tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                                    var canvasTexture = await new THREE.CanvasTexture(tempCtx.canvas);
                                    canvasTexture.name = xpTitle + _index;
                                    genMat.push(canvasTexture);
                                    node.material.map = canvasTexture;
                                    node.material.needsUpdate = true;
                                    _index++;
                                } else {
                                    knownMat.map((_mat, index) => {
                                        if (_mat === node.material.name) {
                                            node.material.map = genMat[index];
                                            node.material.needsUpdate = true;
                                        }
                                    });
                                }
                        });
                    });
                }
            }
        }
        async function updateText() {
            const st = document.getElementById('sceneText');
            const loader = new THREE.FontLoader();
            loader.load('fonts/helvetiker_regular.typeface.json', function (font) {
                const geometry = new THREE.TextGeometry(st.value.length > 0 ? st.value : 'NAME', {
                    font: font,
                    size: 80,
                    curveSegments: 16,
                    bevelEnabled: false
                });
                const material = new THREE.MeshBasicMaterial({ color: '#' + (Math.random() * 0xFFFFFF << 0).toString(16).padStart(6, '0') });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.name = 'genText';
                mesh.position.x = -0.5;
                const pn = Math.random();
                mesh.position.y = 0.25;
                mesh.position.z = 0;
                mesh.scale.x = .0025;
                mesh.scale.y = .0025;
                mesh.scale.z = .0005;
                mesh.castShadow = true;
                const at = document.getElementById('ageText');
                const ageometry = new THREE.TextGeometry(at.value.length > 0 ? at.value : 'AGE', {
                    font: font,
                    size: 80,
                    curveSegments: 16,
                    bevelEnabled: false,
                });
                const amaterial = new THREE.MeshBasicMaterial({ color: '#' + (Math.random() * 0xFFFFFF << 0).toString(16).padStart(6, '0') });
                const amesh = new THREE.Mesh(ageometry, amaterial);
                amesh.name = 'agenText';
                amesh.position.x = -0.5;
                const apn = Math.random();
                amesh.position.y = 0;
                amesh.position.z = 0;
                amesh.scale.x = .0025;
                amesh.scale.y = .0025;
                amesh.scale.z = .0005;
                amesh.castShadow = true;
                // Add new 3d text to scene
                const sc = document.getElementById('textEntity');
                const ob = sc.object3D;
                const oldT = ob.children.find(function (el) {
                    return el.name == 'genText';
                });
                if (oldT) {
                    ob.remove(oldT);
                }
                ob.add(mesh);
                const aoldT = ob.children.find(function (el) {
                    return el.name == 'agenText';
                });
                if (aoldT) {
                    ob.remove(aoldT);
                }
                ob.add(amesh);
            });
        }
        const swipeArr = [], senseY = 5, senseX = 4;
        let swipeLoaded = false, finishedRunning = true;
        async function updateState(r) {
            const msg = document.getElementById('showHands');
            const text = document.getElementById('textEntity');
            state.running
                && (msg.style.display = '', state.handDetected
                    && (finishedRunning = false, state.running = false, msg.style.display = 'none', checkAnim()));
            if (finishedRunning && r.multiHandWorldLandmarks.length > 0 && r.multiHandedness[0].score > 0.95) {
                finishedRunning = false;
                if (!swipeLoaded) {
                    if (swipeArr.length < 3) {
                        swipeArr.push({ r: r, active: false });
                    } else {
                        swipeArr.push({ r: r, active: true });
                        swipeLoaded = true;
                    }
                }
                await swipeArr.map(async (pos, index) => {
                    if (pos.active) {
                        const _r = pos.r;
                        swipeArr.splice(index, 1, { r: _r, active: false });
                        swipeArr[index].active = false;
                        if (index < swipeArr.length - 1) {
                            swipeArr.splice(index + 1, 1, { r: r, active: true });
                            swipeArr[index + 1].r = r;
                            swipeArr[index + 1].active = true;
                        } else {
                            swipeArr.splice(0, 1, { r: r, active: true });
                            swipeArr[0].r = r;
                            swipeArr[0].active = true;
                        }
                        if (swipeArr[index + 1]) {
                            if (swipeArr[index + 2]) {
                                if (Math.abs(swipeArr[index + 1].r.multiHandWorldLandmarks[0][0].x - swipeArr[index + 2].r.multiHandWorldLandmarks[0][0].x) * 1000 > senseX || Math.abs(swipeArr[index + 1].r.multiHandWorldLandmarks[0][0].y - swipeArr[index + 2].r.multiHandWorldLandmarks[0][0].y) * 1000 > senseY) {
                                    !msg.style.display && (msg.style.display = 'none');
                                    await swipeArr.slice(0, 1);
                                    await swipeArr.splice(0, 1, { r: null, active: false });
                                    document.getElementById('confettiRL').object3D.visible = true;
                                    document.getElementById('confettiLR').object3D.visible = true;
                                    document.getElementById('confettiBL').object3D.visible = true;
                                    document.getElementById('confettiBR').object3D.visible = true;
                                    document.getElementById('confettiBL').setAttribute('particle-system', 'color: #EFaa22,#44CC00; velocityValue: 6 12 -9; particleCount: 350; size: 0.35; duration: 4;');
                                    document.getElementById('confettiBR').setAttribute('particle-system', 'color: #EF0000,#EFaa22; velocityValue: -6 12 -9; particleCount: 350; size: 0.35; duration: 4;');
                                } else {
                                    finishedRunning = true;
                                }
                            } else {
                                if ((swipeArr[index + 1].r.multiHandWorldLandmarks[0][0].x - swipeArr[0].r.multiHandWorldLandmarks[0][0].x) * 1000 > senseX || (swipeArr[index + 1].r.multiHandWorldLandmarks[0][0].y - swipeArr[0].r.multiHandWorldLandmarks[0][0].y) * 1000 > senseY) {
                                    !msg.style.display && (msg.style.display = 'none');
                                    await swipeArr.slice(0, 1);
                                    await swipeArr.splice(0, 1, { r: null, active: false });
                                    document.getElementById('confettiRL').object3D.visible = true;
                                    document.getElementById('confettiLR').object3D.visible = true;
                                    document.getElementById('confettiBL').object3D.visible = true;
                                    document.getElementById('confettiBR').object3D.visible = true;
                                    document.getElementById('confettiBL').setAttribute('particle-system', 'color: #EFaa22,#44CC00; velocityValue: 6 12 -9; particleCount: 350; size: 0.35; duration: 4;');
                                    document.getElementById('confettiBR').setAttribute('particle-system', 'color: #EF0000,#EFaa22; velocityValue: -6 12 -9; particleCount: 350; size: 0.35; duration: 4;');
                                } else {
                                    finishedRunning = true;
                                }
                            }
                        } else {
                            if ((swipeArr[0].r.multiHandWorldLandmarks[0][0].x - swipeArr[swipeArr.length - 1].r.multiHandWorldLandmarks[0][0].x) * 1000 > senseX || (swipeArr[0].r.multiHandWorldLandmarks[0][0].y - swipeArr[swipeArr.length - 1].r.multiHandWorldLandmarks[0][0].y) * 1000 > senseY) {
                                !msg.style.display && (msg.style.display = 'none');
                                await swipeArr.slice(0, 1);
                                await swipeArr.splice(0, 1, { r: null, active: false });
                                document.getElementById('confettiRL').object3D.visible = true;
                                document.getElementById('confettiLR').object3D.visible = true;
                                document.getElementById('confettiBL').object3D.visible = true;
                                document.getElementById('confettiBR').object3D.visible = true;
                                document.getElementById('confettiBL').setAttribute('particle-system', 'color: #EFaa22,#44CC00; velocityValue: 6 12 -9; particleCount: 350; size: 0.35; duration: 4;');
                                document.getElementById('confettiBR').setAttribute('particle-system', 'color: #EF0000,#EFaa22; velocityValue: -6 12 -9; particleCount: 350; size: 0.35; duration: 4;');
                            } else {
                                finishedRunning = true;
                            }
                        }
                    } else {
                        r && (finishedRunning = true);
                    }
                });
            }
        }
        function checkAnim() {
            if (!state.xpStarted) {
                state.xpStarted = true;
                const cake = document.getElementById('3d-object');
                const text = document.getElementById('textEntity');
                cake.dispatchEvent(new Event('startAnim'));
                text.dispatchEvent(new Event('startAnim'));
                text.setAttribute('position', '0 1.6 -2');
                setTimeout(() => {
                    const msg = document.getElementById('showHands');
                    msg.style.display = '';
                    msg.children.item(0).innerHTML = 'Swipe your hand across your back camera to get A surprise! Make a wish!';
                    finishedRunning = true;
                }, 4000);
            }
            /** Swipe your hand across your back camera to get A surprise! Make a wish! **/
        }
        function setVisible() {
            const bar = document.getElementById('customBar');
            const btn = document.getElementById('setVisible');
            const name = document.getElementById('sceneText').value;
            if (name)
                if (bar.style.display !== 'none') {
                    bar.style.display = 'none';
                    btn.style.display = 'inline-block';
                    state.running = true;
                } else {
                    bar.style.display = 'inherit';
                    btn.style.display = 'none';
                    state.running = false;
                } else alert('You forgot to enter your name');
        }
    </script>
</head>

<body>
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
        <video id="input-video" width="100%" height="100%" muted autoplay playsinline></video>
    </div>
    <!-- AFRAME -->
    <a-scene id="scene" arjs embedded renderer="logarithmicDepthBuffer: true; antialias: true;"
        vr-mode-ui="enabled: false" gltf-model="dracoDecoderPath: https://www.gstatic.com/draco/v1/decoders/;">
        <a-assets timeout="15000">
            <a-asset-item id="model" src="models/t3cake.glb"></a-asset-item>
        </a-assets>
        <a-entity id="capsule">
            <a-entity id="textEntity" position="0 80 -4">
            </a-entity>
            <a-entity id="confettiRL"
                particle-system="accelerationSpread: 20 0 20; color: #EFaa22; particleCount: 600; opacity: 1; preset: default; size: 0.75; velocityValue: 0 15 0"
                position="5.584 1.250 -1.4">
            </a-entity>
            <a-entity id="confettiLR"
                particle-system="accelerationSpread: 20 0 20; color: #EFaa22; particleCount: 600; opacity: 1; preset: default; size: 0.75; velocityValue: 0 15 0"
                position="-5.584 1.250 -1.4">
            </a-entity>
            <a-entity id="confettiBL" position="-1 0 -2">
            </a-entity>
            <a-entity id="confettiBR" position="1 0 -2">
            </a-entity>
            <a-entity id="3d-object" gltf-model="#model" animation-mixer class="clickable" autoscale
                material="color: red" position="0 -.1675 0" scale=".125 .125 .125"
                animation__1="property: position; from: 0 1 -4; to: 0 0.5 -4; dur: 4000; startEvents: startAnim, animationcomplete__2"
                animation__2="property: position; from: 0 0.5 -4; to: 0 1 -4; dur: 4000; startEvents: animationcomplete__1"
                animation__3="property: rotation; from: 0 0 0; to: 0 360 0; dur: 8000; loop: true; easing: linear">
            </a-entity>
        </a-entity>
        <a-entity cursor="fuse: false;" raycaster="objects: .clickable">
        </a-entity>
    </a-scene>
    <div id="customBar"
        style="position: absolute; top: 22%; left: 14%; width: 72%; height: 40%; background-color: #0fb3ffd7; border-radius: 9pt; z-index: 1;">
        <div style=" display: flex; flex-direction: column; width: 100%; height: 100%; justify-content: space-evenly">
            <div style="flex: 1; display: flex">
                <div style="margin: auto; width: 90%;">
                    <label for="sceneText" class="inputLabel">Enter Your Name</label>
                    <input class="mainInput" type="text" id="sceneText" name="sceneText" placeholder="NAME"
                        maxlength="24" onkeyup="this.value = this.value.toLocaleUpperCase()">
                </div>
            </div>
            <div style="flex: 1; display: flex">
                <div style="margin: auto; width: 90%;">
                    <label for="ageText" class="inputLabel">Your Age</label>
                    <input class="mainInput" type="text" id="ageText" name="ageText" placeholder="AGE" maxlength="3"
                        onkeyup="this.value = this.value.toLocaleUpperCase()">
                </div>
            </div>
            <div style="flex: 1; display: flex">
                <div style="margin: auto; width: 90%;">
                    <p class="inputInstruction">
                        Please turn up audio for the best experience.
                    </p>
                </div>
            </div>
            <div style="flex: 2; display: flex; flex-direction: column; justify-content: center">
                <div onclick="setVisible(), updateText()"
                    style="display: flex; margin: auto; width: 50%; height: 30%; background-color: #FF006E; color: white;">
                    <p class="btnText">SUBMIT</p>
                </div>
            </div>
        </div>
    </div>
    <button id="setVisible" onclick="setVisible()" style="
                            display: none;
                            position: absolute;
                            top: 10%;
                            right: 5%;
            				background-color: rgba(0,0,0,.6);
            				border: solid;
            				border-radius: 16px;
                            width: 32px;
                            height: 32px;
            				border-width: 1px;
            				color: rgb(230,230,230);
            				text-align: center;
            				text-decoration: none;
            				font-size: 16px;
                            z-index: 1;">+</button>
    <div id="showHands"
        style="position: fixed; bottom: 150px; left: 20%; width: 60%; background-color: #0FB5FF; color:#f3f3f3; text-align: center; display: none; border-radius: 9pt; z-index: 1;">
        <h3>To begin hold a single hand up in front of your phones back camera.</h3>
        <img src="img/icon_hand.svg" />
    </div>
    <div id="frameDiv"
        style="position: fixed; top: 0px; width: 100%; height: 100%; background-color: transparent; z-index: 0;">
        <img src="img/blue_frame.svg" width="100%" height="83.5%"
            style="transform: scale(1, 1.1); position: fixed; top: 0%; left: 0%;" />
        <img src="img/icon_flags.svg" width="100%" height="10%" style="position: fixed; top: 0%; left: 0%;" />
        <div style="position: fixed; top: 0px; left: 40.035%; width: 19.2307%; height: 7.109%; background: #0FB5FF;">
        </div>
        <img src="img/icons_balloons_one.svg" width="38.7179%" height="22.0379%"
            style="position: fixed; right: 0%; bottom: 10%;" />
        <img src="img/icon_ballons_two.svg" width="38.7179%" height="22.0379%"
            style="position: fixed; left: 0%; bottom: 9%; background: transparent;" />
    </div>
    <!-- ACTION BAR -->
    <div class="action-bar-container">
        <div
            style="width: 95%;margin: auto;display: flex;align-items: center;justify-content: center;padding: 15px 0 0px;">
            <div class="detail-line"></div>
        </div>
        <div class="action-bar-buttons">
            <button class="action-bar-button" onclick="resetPosition()">
                <svg xmlns="http://www.w3.org/2000/svg" width="27.028" height="30.494" viewbox="0 0 27.028 30.494">
                    <path id="icon_reset"
                        d="M132.44,14h-9.373a8.843,8.843,0,0,0-8.827,8.827v7.7a1.284,1.284,0,1,0,2.568,0v-7.7a6.233,6.233,0,0,1,6.227-6.227h9.341a6.247,6.247,0,0,1,6.291,6.227v6.741A6.233,6.233,0,0,1,132.44,35.8H120.852l3.884-3.884a1.294,1.294,0,0,0-1.83-1.83l-6.1,6.1a1.279,1.279,0,0,0,0,1.83l6.1,6.1a1.285,1.285,0,0,0,.931.385,1.339,1.339,0,0,0,.931-.385,1.279,1.279,0,0,0,0-1.83L120.852,38.4H132.44a8.822,8.822,0,0,0,8.827-8.827V22.827A8.843,8.843,0,0,0,132.44,14Z"
                        transform="translate(-114.24 -14)" fill="#f8f93a" />
                </svg>
                Reset
            </button>
            <button class="action-bar-button" onclick="takePhoto()">
                <svg xmlns="http://www.w3.org/2000/svg" width="35" height="29" viewbox="0 0 35 29">
                    <g id="icon_camera" transform="translate(-0.5 -3.5)">
                        <path id="Path_2915" data-name="Path 2915"
                            d="M34.5,28.5a3,3,0,0,1-3,3H4.5a3,3,0,0,1-3-3V12a3,3,0,0,1,3-3h6l3-4.5h9l3,4.5h6a3,3,0,0,1,3,3Z"
                            fill="none" stroke="#ffe900" stroke-linecap="round" stroke-linejoin="round"
                            stroke-width="2" />
                        <path id="Path_2916" data-name="Path 2916" d="M24,19.5a6,6,0,1,1-6-6,6,6,0,0,1,6,6Z" fill="none"
                            stroke="#0fb5ff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" />
                    </g>
                </svg>
                Take A Photo
            </button>
            <button class="action-bar-button" onclick="openQrScanner('{{ url(` qrscanner`) }}')">
                <svg xmlns="http://www.w3.org/2000/svg" width="28.885" height="28.884" viewbox="0 0 28.885 28.884">
                    <g id="icon_scan_qr" transform="translate(-1370.614 -437.68)">
                        <path id="Path_6533" data-name="Path 6533"
                            d="M110.095,42.978a.963.963,0,0,0-.963-.963h-7.7a.962.962,0,0,0-.963.963v7.7a.963.963,0,0,0,.963.963h7.7a.963.963,0,0,0,.963-.963Zm11.554,0a.962.962,0,0,0-.963-.963h-7.7a.962.962,0,0,0-.963.963v7.7a.963.963,0,0,0,.963.963h7.7a.963.963,0,0,0,.963-.963Zm-13.48.963v5.777h-5.777V43.941Zm11.554,0v5.777h-5.777V43.941ZM110.1,31.424a.963.963,0,0,0-.963-.963h-7.7a.962.962,0,0,0-.963.963v7.7a.963.963,0,0,0,.963.963h7.7a.963.963,0,0,0,.963-.963Zm11.554,0a.963.963,0,0,0-.963-.963h-7.7a.962.962,0,0,0-.963.963v7.7a.963.963,0,0,0,.963.963h7.7a.963.963,0,0,0,.963-.963Zm-13.48.963v5.777h-5.777V32.387Zm11.554,0v5.777h-5.777V32.387Z"
                            transform="translate(1273.998 411.07)" fill="#0fb5ff" fill-rule="evenodd" />
                        <path id="Path_6534" data-name="Path 6534"
                            d="M87.41,38.586v6.74a.963.963,0,0,0,.963.963h6.74a.963.963,0,0,0,0-1.925H89.336V38.586a.963.963,0,1,0-1.926,0Zm26.959,0v5.777h-5.777a.963.963,0,1,0,0,1.925h6.74a.962.962,0,0,0,.963-.963v-6.74a.963.963,0,1,0-1.925,0ZM89.336,25.107V19.33h5.777a.963.963,0,0,0,0-1.926h-6.74a.963.963,0,0,0-.963.963v6.74a.963.963,0,0,0,1.926,0Zm26.958,0v-6.74a.963.963,0,0,0-.963-.963h-6.74a.963.963,0,1,0,0,1.926h5.777v5.777a.963.963,0,1,0,1.925,0Z"
                            transform="translate(1283.204 420.276)" fill="#ffe900" fill-rule="evenodd" />
                    </g>
                </svg>
                Scan Another
            </button>
        </div>
    </div>
    <!-- TEMPORARY CANVAS USED TO BUILD FINAL IMAGE -->
    <canvas style="position: relative; top: 0; left: 0;" id="canvas1">
    </canvas>
    <canvas style="position: relative; top: 0; left: 0;" id="canvas2">
    </canvas>
    <!-- REVIEW VIEW -->
    <div id="review_modal" style="
		position: fixed; 
		top: 0; 
		left: 0; 
		width: 100%; 
		height: 100%; 
		background-color: rgb(255,255,255);
		display: none;
		z-index: 3;">
        <div
            style="width: 100%; padding-top: 16px; padding-bottom: 16px; padding-left: 8px; background-color: rgba(0,0,0,.6); pointer-events: none;">
            <button onclick="closeReview()" style="
				background-color: rgba(0,0,0,.6);
				border: solid;
				border-radius: 12px;
				border-width: 1px; 
				color: rgb(230,230,230);
				padding: 8px 8px;
				text-align: center;
				text-decoration: none;
				font-size: 12px;
				pointer-events: auto;">Back</button>
        </div>
        <div style="width: 100%;">
            <div id="loader" style="
				position: fixed; 
				top: 25%; 
				z-index: -1;
				left: 50%;
				margin-left: -40px;
				border: 10px solid #f3f3f3;
				border-radius: 50%;
				border-top: 10px solid #00ff00;
				width: 80px;
				height: 80px;
				-webkit-animation: spin 2s linear infinite; /* Safari */
				animation: spin 2s linear infinite;"></div>
            <img id="review-img" style="width: 100%; pointer-events: auto;" />
            <div style="width: 90%; margin: auto; pointer-events: none;">
                <p style="text-align: center;">Tap and hold on the image to save to your photos or share</p>
            </div>
        </div>
    </div>
</body>

</html>
